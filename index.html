<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Mini Radio FM</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #0f172a;
      --bg-dark: #020617;
      --primary: #38bdf8;
      --secondary: #22c55e;
      --accent: #f97316;
      --text: #e5e7eb;
      --text-muted: #9ca3af;
      --card: #111827;
      --border: #1f2937;
      --radius-xl: 18px;
    }

    body[data-theme="light"] {
      --bg: #e5e7eb;
      --bg-dark: #f9fafb;
      --primary: #2563eb;
      --secondary: #16a34a;
      --accent: #ea580c;
      --text: #020617;
      --text-muted: #6b7280;
      --card: #ffffff;
      --border: #d1d5db;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, var(--bg), var(--bg-dark));
      color: var(--text);
      transition: background 0.25s ease-out, color 0.25s ease-out;
    }

    .device {
      width: 320px;
      max-width: 92vw;
      background: linear-gradient(145deg, var(--card), var(--bg-dark));
      border-radius: 26px;
      padding: 16px 16px 16px;
      border: 1px solid var(--border);
      box-shadow:
        0 20px 45px rgba(0, 0, 0, 0.35),
        inset 0 0 0 1px rgba(148, 163, 184, 0.08);
      display: flex;
      flex-direction: column;
      gap: 10px;
      transition: background 0.25s ease-out, border-color 0.25s ease-out;
    }

    .device-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .logo {
      font-weight: 700;
      letter-spacing: 0.08em;
      font-size: 0.7rem;
      text-transform: uppercase;
      color: var(--primary);
    }

    .theme-toggle {
      border: none;
      background: rgba(15, 23, 42, 0.12);
      border-radius: 999px;
      padding: 2px 8px;
      font-size: 0.75rem;
      cursor: pointer;
      color: var(--text-muted);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    body[data-theme="light"] .theme-toggle {
      background: rgba(148, 163, 184, 0.18);
    }

    .theme-toggle span {
      font-size: 0.85rem;
    }

    .screen {
      background: radial-gradient(circle at top left, var(--card), var(--bg-dark));
      border-radius: var(--radius-xl);
      border: 1px solid var(--border);
      padding: 10px 12px;
      box-shadow:
        inset 0 0 0 1px rgba(15, 23, 42, 0.35),
        0 12px 24px rgba(0, 0, 0, 0.35);
      transition: background 0.25s ease-out, border-color 0.25s ease-out;
    }

    body[data-theme="light"] .screen {
      box-shadow:
        inset 0 0 0 1px rgba(148, 163, 184, 0.25),
        0 12px 24px rgba(15, 23, 42, 0.18);
    }

    .tabs {
      display: flex;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      padding: 3px;
      margin-bottom: 8px;
      gap: 4px;
      font-size: 0.7rem;
    }

    body[data-theme="light"] .tabs {
      background: rgba(209, 213, 219, 0.95);
    }

    .tab {
      flex: 1;
      text-align: center;
      padding: 4px 0;
      border-radius: 999px;
      cursor: pointer;
      user-select: none;
      color: var(--text-muted);
      transition: all 0.15s ease-out;
    }

    .tab.active {
      background: linear-gradient(135deg, var(--primary), #6366f1);
      color: #0b1120;
      font-weight: 600;
      box-shadow: 0 0 12px rgba(56, 189, 248, 0.5);
    }

    .screen-body {
      min-height: 140px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .screen-hero {
      width: 100%;
      height: 70px;
      border-radius: 14px;
      background: radial-gradient(circle at 20% 20%, #1f2937, #020617);
      border: 1px solid rgba(15, 23, 42, 0.75);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 4px;
      overflow: hidden;
      position: relative;
    }

    .fm-hero-viz {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      opacity: 0.55;
      pointer-events: none;
    }

    body[data-theme="light"] .screen-hero {
      background: radial-gradient(circle at 20% 20%, #e5e7eb, #cbd5f5);
      border-color: rgba(148, 163, 184, 0.7);
    }

    .hero-inner {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 6px 10px;
      gap: 10px;
      position: relative;
      z-index: 1;
    }

    .radio-logo-frame {
      width: 68px;
      height: 68px;
      border-radius: 14px;
      overflow: hidden;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.45);
      background: #020617;
      flex-shrink: 0;
    }

    .radio-logo {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .hero-text {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 2px;
    }

    .hero-title {
      font-size: 0.9rem;
      font-weight: 600;
    }

    .hero-sub {
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .title-row {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      font-size: 0.8rem;
    }

    .mode-title {
      font-weight: 600;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: var(--text);
    }

    .subtitle {
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .fm-frequency {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-top: 4px;
    }

    .freq-display {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
    }

    .freq-main {
      font-size: 1.6rem;
      font-weight: 700;
      letter-spacing: 0.05em;
    }

    .freq-main span {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-left: 2px;
      font-weight: 400;
    }

    .station-name {
      font-size: 0.8rem;
      color: var(--primary);
      font-weight: 500;
    }

    .freq-slider {
      width: 100%;
      margin-top: 4px;
    }

    input[type="range"] {
      -webkit-appearance: none;
      width: 100%;
      background: transparent;
    }

    input[type="range"]:focus {
      outline: none;
    }

    input[type="range"]::-webkit-slider-runnable-track {
      height: 4px;
      background: linear-gradient(90deg, var(--primary), var(--accent));
      border-radius: 999px;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 14px;
      height: 14px;
      border-radius: 999px;
      background: #f9fafb;
      border: 2px solid #0f172a;
      margin-top: -5px;
      box-shadow: 0 0 6px rgba(59, 130, 246, 0.8);
    }

    input[type="range"]::-moz-range-track {
      height: 4px;
      background: linear-gradient(90deg, var(--primary), var(--accent));
      border-radius: 999px;
    }

    input[type="range"]::-moz-range-thumb {
      width: 14px;
      height: 14px;
      border-radius: 999px;
      background: #f9fafb;
      border: 2px solid #0f172a;
      box-shadow: 0 0 6px rgba(59, 130, 246, 0.8);
    }

    /* Ligne Menu / Prev / Next à la place du RDS */
    .fm-controls-inline {
      margin-top: 4px;
      display: flex;
      justify-content: space-between;
      gap: 6px;
      font-size: 0.7rem;
    }

    .fm-inline-btn {
      flex: 1;
      padding: 2px 4px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      background: transparent;
      color: var(--text-muted);
      cursor: pointer;
    }

    .fm-inline-btn:hover {
      background: rgba(56, 189, 248, 0.12);
      color: var(--primary);
    }

    /* FAVORIS */
    .favorites-section {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 2px;
    }

    .favorites-group-title {
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-muted);
      margin-bottom: 2px;
    }

    .favorites-list {
      border-radius: 10px;
      border: 1px solid rgba(15, 23, 42, 0.5);
      padding: 4px;
      max-height: 80px;
      overflow-y: auto;
      scrollbar-width: thin;
    }

    body[data-theme="light"] .favorites-list {
      border-color: rgba(148, 163, 184, 0.6);
    }

    .favorite-item {
      font-size: 0.75rem;
      padding: 3px 6px;
      border-radius: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      margin-bottom: 2px;
      color: var(--text-muted);
      transition: background 0.12s ease-out, color 0.12s ease-out;
    }

    .favorite-item span:first-child {
      max-width: 160px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .favorite-item:hover {
      background: rgba(56, 189, 248, 0.08);
      color: var(--primary);
    }

    .fav-empty {
      font-size: 0.7rem;
      color: var(--text-muted);
      font-style: italic;
      padding: 2px 0;
    }

    @media (max-width: 360px) {
      .device {
        padding: 12px 10px 12px;
        border-radius: 20px;
      }
      .screen-hero {
        height: 60px;
      }
      .radio-logo-frame {
        width: 56px;
        height: 56px;
      }
      .hero-title {
        font-size: 0.8rem;
      }
      .hero-sub {
        font-size: 0.7rem;
      }
      .freq-main {
        font-size: 1.4rem;
      }
    }
  </style>
</head>
<body data-theme="dark">
  <div class="device">
    <div class="device-header">
      <div class="logo">neoFM</div>
      <button class="theme-toggle" id="theme-toggle" type="button">
        <span id="theme-icon">☾</span>
        <span id="theme-label">Sombre</span>
      </button>
    </div>

    <div class="screen">
      <div class="tabs">
        <div class="tab active" data-tab="radio">Radio FM</div>
        <div class="tab" data-tab="favorites">Favoris</div>
      </div>

      <!-- RADIO FM -->
      <div class="screen-body" id="screen-radio">
        <div class="screen-hero">
          <canvas id="fm-hero-viz" class="fm-hero-viz"></canvas>
          <div class="hero-inner">
            <div class="radio-logo-frame">
              <img
                id="radio-logo"
                src="img/radio-default.png"
                alt="Logo radio"
                class="radio-logo"
              />
            </div>
            <div class="hero-text">
              <div class="hero-title" id="radio-hero-title">Nova Mix</div>
              <div class="hero-sub" id="radio-hero-sub">100% hits &amp; news</div>
            </div>
          </div>
        </div>

        <div class="title-row">
          <div>
            <div class="mode-title">Radio FM</div>
            <div class="subtitle">Tuner numérique • RDS</div>
          </div>
        </div>

        <div class="fm-frequency">
          <div class="freq-display">
            <div class="freq-main" id="freq-value">
              99.3<span>MHz</span>
            </div>
            <div class="station-name" id="station-name">Nova Mix</div>
          </div>
          <input
            id="freq-slider"
            type="range"
            min="875"
            max="1080"
            value="993"
            step="1"
            class="freq-slider"
          />
          <div class="fm-controls-inline">
            <button class="fm-inline-btn" id="inline-menu">Menu</button>
            <button class="fm-inline-btn" id="inline-prev">◀◀</button>
            <button class="fm-inline-btn" id="inline-next">▶▶</button>
          </div>
        </div>
      </div>

      <!-- FAVORIS -->
      <div class="screen-body" id="screen-favorites" style="display: none;">
        <div class="title-row">
          <div>
            <div class="mode-title">Favoris</div>
            <div class="subtitle">Stations FM</div>
          </div>
          <div class="pill">Touche F = ★</div>
        </div>

        <div class="favorites-section">
          <div>
            <div class="favorites-group-title">FM</div>
            <div class="favorites-list" id="favorites-fm"></div>
          </div>
        </div>
      </div>
    </div>

    <audio id="audio-player"></audio>
  </div>

  <script>
    // THÈME
    const themeToggle = document.getElementById("theme-toggle");
    const themeIcon = document.getElementById("theme-icon");
    const themeLabel = document.getElementById("theme-label");

    function applyTheme(theme) {
      document.body.setAttribute("data-theme", theme);
      if (theme === "light") {
        themeIcon.textContent = "☀";
        themeLabel.textContent = "Clair";
      } else {
        themeIcon.textContent = "☾";
        themeLabel.textContent = "Sombre";
      }
      try {
        localStorage.setItem("neo-theme", theme);
      } catch (e) {}
    }

    (function () {
      let saved = null;
      try {
        saved = localStorage.getItem("neo-theme");
      } catch (e) {}
      if (saved === "light" || saved === "dark") {
        applyTheme(saved);
      } else {
        applyTheme("dark");
      }
    })();

    themeToggle.addEventListener("click", () => {
      const current = document.body.getAttribute("data-theme") || "dark";
      applyTheme(current === "dark" ? "light" : "dark");
    });

    // LOGIQUE GÉNÉRALE
    const tabs = document.querySelectorAll(".tab");
    const screenRadio = document.getElementById("screen-radio");
    const screenFavorites = document.getElementById("screen-favorites");
    const audio = document.getElementById("audio-player");
    audio.crossOrigin = "anonymous";

    let mode = "radio"; // "radio" | "favorites"
    const tabOrder = ["radio", "favorites"];
    let currentTabIndex = 0;
    let isPlaying = false;

    // FAVORIS FM
    const favoriteManager = {
      key: "neo-favorites-fm-only",
      data: { fm: [] }, // [{freq, name}]

      load() {
        try {
          const raw = localStorage.getItem(this.key);
          if (!raw) return;
          const parsed = JSON.parse(raw);
          this.data.fm = Array.isArray(parsed.fm) ? parsed.fm : [];
        } catch (e) {
          this.data = { fm: [] };
        }
      },

      save() {
        try {
          localStorage.setItem(this.key, JSON.stringify(this.data));
        } catch (e) {}
      },

      isFMFavorite(station) {
        if (!station) return false;
        return this.data.fm.some(
          (f) => f.freq === station.freq && f.name === station.name
        );
      },

      toggleFM(station) {
        if (!station) return;
        const idx = this.data.fm.findIndex(
          (f) => f.freq === station.freq && f.name === station.name
        );
        if (idx === -1) {
          this.data.fm.push({ freq: station.freq, name: station.name });
        } else {
          this.data.fm.splice(idx, 1);
        }
        this.save();
      },

      getFMFavorites() {
        return this.data.fm;
      },
    };

    function isFavoriteFM(station) {
      return favoriteManager.isFMFavorite(station);
    }

    function toggleFavoriteCurrentStation() {
      if (mode === "radio" && currentFMStation) {
        favoriteManager.toggleFM(currentFMStation);
        updateFrequencyDisplay(parseInt(freqSlider.value, 10));
        renderFavorites();
      }
    }

    document.addEventListener("keydown", (e) => {
      if (e.key.toLowerCase() === "f") {
        toggleFavoriteCurrentStation();
      }
    });

    // Web Audio pour visualizer
    let currentFMStation = null;
    let audioContext = null;
    let sourceNode = null;
    let analyser = null;
    let vizDataArray = null;
    let vizBufferLength = 0;

    const fmHeroCanvas = document.getElementById("fm-hero-viz");
    const fmHeroCtx = fmHeroCanvas ? fmHeroCanvas.getContext("2d") : null;

    function resizeFmHeroCanvas() {
      if (!fmHeroCanvas) return;
      const rect = fmHeroCanvas.getBoundingClientRect();
      fmHeroCanvas.width = rect.width;
      fmHeroCanvas.height = rect.height;
    }

    window.addEventListener("resize", resizeFmHeroCanvas);
    resizeFmHeroCanvas();

    function ensureAudioContext() {
      if (audioContext) return;
      const AC = window.AudioContext || window.webkitAudioContext;
      if (!AC) return;
      audioContext = new AC();
      sourceNode = audioContext.createMediaElementSource(audio);

      analyser = audioContext.createAnalyser();
      analyser.fftSize = 256;
      vizBufferLength = analyser.frequencyBinCount;
      vizDataArray = new Uint8Array(vizBufferLength);

      sourceNode.connect(analyser);
      analyser.connect(audioContext.destination);

      startFmHeroVisualizer();
    }

    function startFmHeroVisualizer() {
      if (!fmHeroCtx || !fmHeroCanvas) return;

      function loop() {
        requestAnimationFrame(loop);

        if (!analyser || !vizDataArray) return;

        const w = fmHeroCanvas.width;
        const h = fmHeroCanvas.height;
        if (!w || !h) return;

        fmHeroCtx.globalAlpha = 0.9;
        fmHeroCtx.fillStyle = "#020617";
        fmHeroCtx.fillRect(0, 0, w, h);
        fmHeroCtx.globalAlpha = 1;

        if (!isPlaying || mode !== "radio") {
          return;
        }

        analyser.getByteFrequencyData(vizDataArray);

        const barPairs = 18; // 18 paires → 36 barres
        const step = Math.floor(vizBufferLength / barPairs) || 1;
        const halfWidth = w / 2;
        const barWidth = (halfWidth / barPairs) * 0.9;
        const color = "#38bdf8";

        for (let i = 0; i < barPairs; i++) {
          let sum = 0;
          for (let j = 0; j < step; j++) {
            sum += vizDataArray[i * step + j] || 0;
          }
          const value = sum / step;
          const norm = value / 255;
          const barHeight = (0.2 + 0.7 * norm) * h;

          const xCenter = halfWidth;
          const xLeft = xCenter - (i + 1) * barWidth;
          const xRight = xCenter + i * barWidth;
          const y = h - barHeight;

          fmHeroCtx.fillStyle = color;
          fmHeroCtx.fillRect(xLeft, y, barWidth - 1, barHeight);
          fmHeroCtx.fillRect(xRight, y, barWidth - 1, barHeight);
        }
      }

      requestAnimationFrame(loop);
    }

    // Onglets
    function showTab(tabName) {
      mode = tabName;
      currentTabIndex = tabOrder.indexOf(tabName);

      tabs.forEach((t) => {
        t.classList.toggle("active", t.getAttribute("data-tab") === tabName);
      });

      screenRadio.style.display = tabName === "radio" ? "flex" : "none";
      screenFavorites.style.display = tabName === "favorites" ? "flex" : "none";

      if (mode === "favorites") {
        renderFavorites();
      }
    }

    tabs.forEach((tab) => {
      tab.addEventListener("click", () => {
        showTab(tab.getAttribute("data-tab"));
      });
    });

    // RADIO FM
    const freqSlider = document.getElementById("freq-slider");
    const freqValue = document.getElementById("freq-value");
    const stationName = document.getElementById("station-name");
    const radioLogo = document.getElementById("radio-logo");
    const radioHeroTitle = document.getElementById("radio-hero-title");
    const radioHeroSub = document.getElementById("radio-hero-sub");
    const DEFAULT_LOGO = "img/radio-default.png";

    let fmStations = [];

    function updateFrequencyDisplay(value) {
      const mhz = (value / 10).toFixed(1);
      freqValue.innerHTML = mhz + '<span>MHz</span>';

      if (!fmStations.length) {
        currentFMStation = null;
        stationName.textContent = "Bruitage";
        radioHeroTitle.textContent = "Chargement…";
        radioHeroSub.textContent = "Stations en cours de chargement";
        radioLogo.src = DEFAULT_LOGO;
        return;
      }

      let closest = fmStations[0];
      let minDiff = Math.abs(value - fmStations[0].freq);
      for (let i = 1; i < fmStations.length; i++) {
        const diff = Math.abs(value - fmStations[i].freq);
        if (diff < minDiff) {
          minDiff = diff;
          closest = fmStations[i];
        }
      }

      if (minDiff <= 4) {
        currentFMStation = closest;
        const favPrefix = isFavoriteFM(closest) ? "★ " : "☆ ";
        stationName.textContent = favPrefix + closest.name;
        radioHeroTitle.textContent = closest.name;
        radioHeroSub.textContent = closest.rds || "";
        radioLogo.src = closest.logo || DEFAULT_LOGO;
      } else {
        currentFMStation = null;
        stationName.textContent = "Bruitage";
        radioHeroTitle.textContent = "Aucune station";
        radioHeroSub.textContent = "Tourne le tuner…";
        radioLogo.src = DEFAULT_LOGO;
      }
    }

    freqSlider.addEventListener("input", (e) => {
      updateFrequencyDisplay(parseInt(e.target.value, 10));
    });

    // FAVORIS
    const favoritesFmEl = document.getElementById("favorites-fm");

    function getFavoriteFMStations() {
      const favDefs = favoriteManager.getFMFavorites();
      return fmStations.filter((st) =>
        favDefs.some((f) => f.freq === st.freq && f.name === st.name)
      );
    }

    function renderFavorites() {
      favoritesFmEl.innerHTML = "";

      const favFM = getFavoriteFMStations();

      if (favFM.length === 0) {
        const empty = document.createElement("div");
        empty.className = "fav-empty";
        empty.textContent =
          "Aucun favori. Va sur Radio FM et appuie sur F.";
        favoritesFmEl.appendChild(empty);
      } else {
        favFM.forEach((st) => {
          const item = document.createElement("div");
          item.className = "favorite-item";
          item.innerHTML =
            "<span>★ " +
            st.name +
            "</span><span>" +
            (st.freq / 10).toFixed(1) +
            " MHz</span>";
          item.addEventListener("click", () => {
            freqSlider.value = st.freq;
            updateFrequencyDisplay(st.freq);
            showTab("radio");
            playFM();
          });
          favoritesFmEl.appendChild(item);
        });
      }
    }

    // FM : lecture
    function playFM() {
      if (!currentFMStation || !currentFMStation.url) {
        console.warn("[FM] Aucune station lockée ou pas d'URL");
        return;
      }

      ensureAudioContext();
      if (audioContext && audioContext.state === "suspended") {
        audioContext.resume().catch(() => {});
      }

      audio.src = currentFMStation.url;
      audio.play()
        .then(() => {
          console.log("[FM] Lecture :", currentFMStation.name, currentFMStation.url);
          isPlaying = true;
        })
        .catch((err) => {
          console.error("[FM] Erreur lecture :", err);
          isPlaying = false;
        });
    }

    function pauseFM() {
      audio.pause();
      isPlaying = false;
      console.log("[FM] Pause");
    }

    function seekFM(direction) {
      if (!fmStations.length) return;

      const currentVal = parseInt(freqSlider.value, 10);
      let targetIndex = 0;

      if (direction > 0) {
        let found = null;
        fmStations.forEach((st, i) => {
          if (
            st.freq > currentVal &&
            (found === null || st.freq < fmStations[found].freq)
          ) {
            found = i;
          }
        });
        targetIndex = found !== null ? found : 0;
      } else {
        let found = null;
        fmStations.forEach((st, i) => {
          if (
            st.freq < currentVal &&
            (found === null || st.freq > fmStations[found].freq)
          ) {
            found = i;
          }
        });
        targetIndex = found !== null ? found : fmStations.length - 1;
      }

      const targetFreq = fmStations[targetIndex].freq;
      freqSlider.value = targetFreq;
      updateFrequencyDisplay(targetFreq);

      if (mode === "radio" && isPlaying) {
        playFM();
      }
    }

    // Boutons inline (Menu / Prev / Next)
    const inlineMenu = document.getElementById("inline-menu");
    const inlinePrev = document.getElementById("inline-prev");
    const inlineNext = document.getElementById("inline-next");

    inlineMenu.addEventListener("click", () => {
      const nextIndex = (currentTabIndex + 1) % tabOrder.length;
      showTab(tabOrder[nextIndex]);
    });

    inlinePrev.addEventListener("click", () => {
      seekFM(-1);
    });

    inlineNext.addEventListener("click", () => {
      seekFM(+1);
    });

    // CHARGEMENT DYNAMIQUE DES STATIONS FM DEPUIS stations.json
    async function loadStationData() {
      try {
        const response = await fetch("stations.json");
        if (!response.ok) {
          throw new Error("HTTP " + response.status);
        }
        const data = await response.json();

        fmStations = data.fmStations || [];

        updateFrequencyDisplay(parseInt(freqSlider.value, 10));

        if (mode === "favorites") {
          renderFavorites();
        }
      } catch (err) {
        console.error("Erreur chargement stations.json :", err);
        stationName.textContent = "Erreur stations.json";
      }
    }

    // INIT
    favoriteManager.load();
    showTab("radio");
    loadStationData();
  </script>
</body>
</html>
